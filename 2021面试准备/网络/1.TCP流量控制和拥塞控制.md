# 流量控制

防止发送方发的太快，耗尽接收方的资源，从而使接收方来不及处理

### 滑动窗口控制：

滑动窗口是类似于一个窗口一样的东西，是用来告诉发送端可以发送数据的大小或者说是窗口标记了接收端缓冲区的大小，这样就可以实现

在确认应答策略中，对每一个发送的数据段，都要给一个ACK确认应答，收到ACK后再发送下一个数据段，这样做有一个比较大的缺点，就是`性能比较差`，尤其是数据往返的时间长的时候

> 使用滑动窗口，就可以一次发送多条数据，从而就提高了性能 可以高效可靠的发送大量的数据

窗口大小指的是无需等待确认应答而可以继续发送数据的最大值，即就是说不需要接收端的应答，可以一次连续的发送数据

# 拥塞控制

防止发送方发的太快，使得网络来不及处理，从而导致网络拥塞

### 加法增加，乘法减少

- 每次收到所有报文的确认后，缓慢增加拥塞窗口，以防网络出现过早拥塞
- 出现一次超时（即出现一次网络拥塞），就把慢开始门限值ssthresh设置为当前的拥塞窗口值乘以0.5

### 慢开始算法

如果立即所大量数据字节注入到网络，那么就有可能引起网络拥塞，因为现在并不清楚网络的负荷情况。
因此，较好的方法是 先探测一下，即由小到大逐渐增大发送窗口，也就是说，由小到大逐渐增大拥塞窗口数值。

还需要设置一个**慢开始门限ssthresh状态变量**。慢开始门限ssthresh的用法如下：

- 当 cwnd < ssthresh 时，使用上述的慢开始算法。
- 当 cwnd > ssthresh 时，停止使用慢开始算法而改用拥塞避免算法。
- 当 cwnd = ssthresh 时，既可使用慢开始算法，也可使用拥塞控制避免算法。



# 区别

## 1.相同点

（1）现象都是丢包；
（2）实现机制都是让发送方发的慢一点，发的少一点

## 2.不同点

（1）丢包位置不同	
流量控制丢包位置是在接收端上
拥塞控制丢包位置是在路由器上
（2）作用的对象不同
流量控制的对象是接收方，怕发送方发的太快，使得接收方来不及处理
拥塞控制的对象是网络，怕发送发发的太快，造成网络拥塞，使得网络来不及处理
3.联系

拥塞控制
     拥塞控制通常表示的是一个全局性的过程，它会涉及到网络中所有的主机、
     所有的路由器和降低网络传输性能的所有因素
流量控制
     流量控制发生在发送端和接收端之间，只是点到点之间的控制



# 超时重传和快重传

**TCP超时重传机制**，结合上面说的**慢启动**和**拥塞避免**使用就是发送完数据后开始倒计时，如果在**重发超时内**没有收到对接收方发来的ACK的话就去执行上述的**乘法减小过程（设置sstresh为原来一半）** 并重新开始慢开始算法，重新发送数据。

**TCP快重传**， 则是允许发送方再连续收到**3 个重复的确认**后就可以开始执行乘法减小过程而**不必再等待重发超时**时间。这就需要**接收方每收到一个*****失序**的报文段就立即发出重复确认以让发送发及早知道有报文段丢失，而不是等待自己发送数据的时候进行捎带确认。

**快重传算法还规定，发送方只要一连收到三个重复确认就应当立即重传对方尚未收到的报文段M3，而不必 继续等待M3设置的重传计时器到期。**
作者：公众号_码农富哥
链接：https://juejin.cn/post/6844904073611722760
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

